import{d as U,I as b,c as I,o as m,a as h,H as g,J as E,K as C,b as f,t as y,F as x,r as R,G as A,h as N,O as V,j as P,u as T}from"./chunks/framework.BpGr-ihe.js";const M='(function(){"use strict";const n=[0,1/0,NaN,Number.MIN_VALUE,Number.MAX_VALUE].flatMap(t=>[t,-t]),s=new DataView(new ArrayBuffer(8));function i(){const t=0|n.length*3*Math.random();return t<n.length?n[t]:(s.setUint32(0,Math.random()*4294967296),s.setUint32(4,Math.random()*4294967296),s.getFloat64(0))}self.onmessage=({data:t})=>{const[o,f]=t,l=new Function(...o,`return ${f}`);let e=0;setInterval(()=>{const c=e+100;for(;e++,e<c;){const r=[];for(let a=0;a<o.length;a++)r.push(i());if(!l(...r)){self.postMessage({type:"fail",arg:r,count:e}),self.close();return}}self.postMessage({type:"ok",count:e})},0)}})();\n',O=typeof self<"u"&&self.Blob&&new Blob([M],{type:"text/javascript;charset=utf-8"});function D(e){let n;try{if(n=O&&(self.URL||self.webkitURL).createObjectURL(O),!n)throw"";const r=new Worker(n,{name:e==null?void 0:e.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(n)}),r}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(M),{name:e==null?void 0:e.name})}finally{n&&(self.URL||self.webkitURL).revokeObjectURL(n)}}const w={"?":[10,11],"||":[20,21],"&&":[30,31],"=":[50,51],"==":[50,51],"<":[50,51],">":[50,51],"<=":[50,51],">=":[50,51],"+":[60,61],"-":[60,61],"*":[70,71],"/":[70,71],"%":[70,71],"^":[91,90],"**":[91,90]},j={"!":40,"+":80,"-":80},S=new RegExp(`(?:${[["num","[0-9]+(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?"],["nm","\\p{XIDS}\\p{XIDC}*"],["sym",[..."(,:)",...Object.keys(w),...Object.keys(j)].sort((e,n)=>n.length-e.length).map(e=>e.replace(/([()|/+*^?])/g,"\\$1")).join("|")],["eof","$"],["err",".*"]].map(([e,n])=>`(?<${e}>${n})`).join("|")})\\s*`,"uy");function B(e){const n=[];for(e=e.trimStart(),S.lastIndex=0;;){const r=S.exec(e).groups;if(r.num!=null)n.push(["num",Number(r.num)]);else if(r.nm!=null)n.push(["nm",r.nm]);else if(r.sym!=null)n.push(["sym",r.sym]);else{if(r.eof!=null)return n;throw`无法解析："${r.err}"`}}}function k(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function F(e){let n=0;function r(){return e[n]??["eof","EOF"]}function t(){const c=r();return n++,c}function i(c,o){return c[0]=="sym"&&c[1]==o}const u=s(0);if(r()[0]!="eof")throw`应结束而非 "${r()[1]}"`;return u;function s(c){let o=t(),l;if(o[0]=="eof")throw"不应结束";if(o[0]!="sym")l=o[1];else if(o[1]=="("){if(l=s(0),o=t(),!i(o,")"))throw`应为右括号而非 "${o[1]}"`}else{if(!k(j,o[1]))throw`"${o[1]}" 不是前缀运算`;const a=s(j[o[1]]);l=["un",o[1],a]}for(;o=r(),o[0]!="eof";){if(i(o,"(")){if(typeof l!="string")throw`应为函数而非 ${d(l)}`;t();const p=[];if(i(r(),")"))t();else for(;p.push(s(0)),o=t(),!i(o,")");)if(!i(o,","))throw`应为逗号或右括号而非 "${o[1]}"`;l=["fn",l,p];continue}if(o[0]!="sym"||!k(w,o[1]))break;const[a,$]=w[o[1]];if(a<c)break;if(t(),o[1]=="?"){const p=s(0);if(o=t(),!i(o,":"))throw`应为冒号而非 "${o[1]}"`;l=["cond",l,p,s($)]}else{const p=s($);l=["bin",o[1],l,p]}}return l}}function d(e){return Array.isArray(e)?e[0]=="fn"?`${e[1]}(${e[2].map(d).join(", ")})`:e[0]=="un"?`(${e[1]}${d(e[2])})`:e[0]=="bin"?`(${d(e[2])} ${e[1]} ${d(e[3])})`:`(${d(e[1])} ? ${d(e[2])} : ${d(e[3])})`:String(e)}const J={NaN:NaN,Infinity:1/0,E:Math.E,PI:Math.PI},_={abs:1,acos:1,acosh:1,asin:1,asinh:1,atan:1,atanh:1,cbrt:1,ceil:1,cos:1,cosh:1,exp:1,expm1:1,floor:1,fround:1,log:1,log1p:1,log10:1,log2:1,round:1,sign:1,sin:1,sinh:1,sqrt:1,tan:1,tanh:1,trunc:1,atan2:2,pow:2,hypot:-1,max:-1,min:-1};function X(e){function n(t,i,u){if(i!=u)throw`${d(t)} 应为 ${i} 而非 ${u}`}n(e,"bool",r(e));function r(t){if(!Array.isArray(t))return"num";if(t[0]=="fn")return t[2].forEach(u=>n(u,"num",r(u))),"num";if(t[0]=="un"){const u=t[1]=="!"?"bool":"num";return n(t[2],u,r(t[2])),u}if(t[0]=="bin"){const u=t[1]=="&&"||t[1]=="||",s=t[1]=="="||t[1]=="==",c=["<",">","<=",">="].includes(t[1]),o=r(t[2]);return u?n(t[2],"bool",o):s||n(t[2],"num",o),n(t[3],o,r(t[3])),u||s||c?"bool":"num"}n(t[1],"bool",r(t[1]));const i=r(t[2]);return n(t[3],i,r(t[3])),i}}function v(e,n){if(typeof e=="number")return String(e);if(typeof e=="string")return k(J,e)?String(e):(n[e]=1,e);if(e[0]=="fn"){if(!k(_,e[1]))throw`"${e[1]}" 不是函数`;if(_[e[1]]!=-1&&_[e[1]]!=e[2].length)throw`需要 ${_[e[1]]} 个参数，但给了 ${e[2].length} 个`;const r=e[2].map(t=>v(t,n)).join(", ");return`Math.${e[1]}(${r})`}if(e[0]=="un")return`(${e[1]}${v(e[2],n)})`;if(e[0]=="bin"){const r=v(e[2],n),t=v(e[3],n);switch(e[1]){case"^":return`(${r} ** ${t})`;case"=":return`Object.is(${r}, ${t})`;case"==":return`(${r} === ${t})`;case"!=":return`(${r} !== ${t})`;default:return`(${r} ${e[1]} ${t})`}}return`(${v(e[1],n)} ? ${v(e[2],n)} : ${v(e[3],n)})`}function L(e){try{const n={},r=F(B(e));return X(r),{kind:"ok",expr:v(r,n),args:Object.keys(n)}}catch(n){return{kind:"err",e:n}}}const W={key:0},q={key:1},K=["disabled"],G=["disabled"],H={key:2},Y={key:3},Z=U({__name:"Main",setup(e){const n=b("x + y = y + x"),r=b(L(n.value).args),t=I(()=>L(n.value)),i=b(0),u=b(),s=b();function c(){if(t.value.kind=="err")return;i.value=0,r.value=t.value.args,u.value=void 0,o();const l=new D;s.value=l,l.postMessage([t.value.args,t.value.expr]),l.onmessage=({data:a})=>{i.value=a.count,a.type=="fail"&&(o(),u.value=a.arg)}}function o(){var l;(l=s.value)==null||l.terminate(),s.value=void 0}return(l,a)=>(m(),h(x,null,[a[4]||(a[4]=g(" 表达式：")),E(f("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=$=>n.value=$)},null,512),[[C,n.value]]),a[5]||(a[5]=g("（结果为布尔值） ")),t.value.kind=="ok"?(m(),h("div",W,[g(" 随机变量："+y(t.value.args.join(", ")),1),a[1]||(a[1]=f("br",null,null,-1)),a[2]||(a[2]=g(" 对应的 JS 代码：")),f("code",null,y(t.value.expr),1)])):(m(),h("div",q," 解析错误："+y(t.value.e),1)),a[6]||(a[6]=f("hr",null,null,-1)),f("button",{type:"button",onClick:c,disabled:t.value.kind=="err"},"开始测试",8,K),f("button",{type:"button",onClick:o,disabled:s.value==null},"停止测试",8,G),f("div",null,y(s.value?"正":"不")+"在运行，已执行 "+y(i.value)+" 次测试。 ",1),u.value!=null?(m(),h("div",H,[a[3]||(a[3]=g(" 测试发现问题，参数： ")),f("ul",null,[(m(!0),h(x,null,R(u.value,($,p)=>(m(),h("li",null,[f("code",null,y(r.value[p])+" = "+y(Object.is(-0,$)?"-0":String($)),1)]))),256))])])):(m(),h("div",Y," 测试暂未发现问题 "))],64))}}),ee=JSON.parse('{"title":"浮点数性质测试","description":"","frontmatter":{"title":"浮点数性质测试"},"headers":[],"relativePath":"project/numtest.md","filePath":"project/numtest.md"}'),z={name:"project/numtest.md"},te=Object.assign(z,{setup(e){return(n,r)=>{const t=P("ClientOnly");return m(),h("div",null,[r[0]||(r[0]=A("",6)),N(t,null,{default:V(()=>[N(T(Z))]),_:1})])}}});export{ee as __pageData,te as default};
